<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp React Channel Tool (Debug Mode)</title>
    <style>
        /* --- CSS TETAP SAMA (HACKER THEME) --- */
        body {
            background-color: #000000;
            color: #39ff14;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            flex-direction: column;
            padding: 20px;
        }

        .container {
            border: 2px solid #39ff14;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 10px rgba(57, 255, 20, 0.2);
            width: 100%;
            max-width: 450px;
            text-align: center;
            backdrop-filter: blur(5px);
            margin-bottom: 20px;
        }

        h1 { margin-bottom: 20px; text-shadow: 0 0 10px #39ff14; }
        .input-group { margin-bottom: 20px; text-align: left; }
        label { font-weight: bold; display: block; margin-bottom: 5px; }
        
        input {
            width: 100%;
            padding: 10px;
            background-color: #111;
            border: 1px solid #39ff14;
            color: #fff;
            border-radius: 5px;
            box-sizing: border-box;
            outline: none;
            transition: 0.3s;
        }
        input:focus { box-shadow: 0 0 15px rgba(57, 255, 20, 0.5); }

        .glow-button {
            background-color: transparent;
            color: #39ff14;
            border: 2px solid #39ff14;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s ease-in-out;
            text-transform: uppercase;
            letter-spacing: 2px;
            width: 100%;
        }
        .glow-button:hover, .glow-button:active {
            background-color: #39ff14;
            color: #000;
            box-shadow: 0 0 20px #39ff14, 0 0 40px #39ff14;
            transform: scale(1.05);
        }

        /* --- LOG BOX BARU --- */
        .debug-box {
            width: 100%;
            max-width: 450px;
            background-color: #0a0a0a;
            border: 1px dashed #39ff14;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            text-align: left;
            height: 200px;
            overflow-y: auto;
            color: #ccc;
        }
        
        .log-entry { margin-bottom: 5px; border-bottom: 1px solid #222; padding-bottom: 2px; }
        .log-time { color: #888; font-size: 10px; }
        .log-info { color: #39ff14; }
        .log-error { color: #ff3333; font-weight: bold; }
        .log-warn { color: #ffff33; }

        /* Scrollbar custom biar matching */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #39ff14; border-radius: 4px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>‚ö° WA REACT TOOL ‚ö°</h1>
        
        <div class="input-group">
            <label>Link Target:</label>
            <input type="text" id="linkInput" placeholder="https://whatsapp.com/channel/..." value="https://whatsapp.com/channel/0029VagAd3L4CrqiS4t2n008">
        </div>

        <div class="input-group">
            <label>Emoji (Pisahkan spasi):</label>
            <input type="text" id="emojiInput" placeholder="üëç ‚ù§Ô∏è üòÇ" value="üëç">
        </div>

        <button class="glow-button" onclick="kirimReact()">GAS KIRIM!</button>
    </div>

    <div class="debug-box" id="debugConsole">
        <div class="log-entry"><span class="log-time">[SYSTEM]</span> Siap memproses data...</div>
    </div>

    <script>
        // Fungsi buat nulis log ke layar
        function log(message, type = 'info') {
            const consoleBox = document.getElementById('debugConsole');
            const time = new Date().toLocaleTimeString();
            let colorClass = 'log-info';
            
            if (type === 'error') colorClass = 'log-error';
            if (type === 'warn') colorClass = 'log-warn';

            consoleBox.innerHTML += `
                <div class="log-entry">
                    <span class="log-time">[${time}]</span> 
                    <span class="${colorClass}">${message}</span>
                </div>`;
            
            // Auto scroll ke bawah
            consoleBox.scrollTop = consoleBox.scrollHeight;
        }

        async function kirimReact() {
            const link = document.getElementById('linkInput').value;
            const emojiRaw = document.getElementById('emojiInput').value;
            const btn = document.querySelector('.glow-button');

            log("--- MEMULAI REQUEST BARU ---", 'warn');

            if (!link || !emojiRaw) {
                log("‚ùå Input masih kosong, gagal memproses.", 'error');
                alert("Isi dulu woi! üóø");
                return;
            }

            btn.innerHTML = "LOADING...";
            btn.style.opacity = "0.7";

            const emojiList = emojiRaw.replace(/,/g, " ").split(/\s+/).filter(e => e.trim());
            const emojiFinal = emojiList.join(",");
            const apiKey = ""; // Isi jika ada

            // Log parameter yang dikirim
            log(`üìù Link: ${link}`);
            log(`üìù Emoji: ${emojiFinal}`);

            const url = `https://react.whyux-xec.my.id/api/rch?link=${encodeURIComponent(link)}&emoji=${encodeURIComponent(emojiFinal)}`;
            log(`üåê Hit URL: ${url}`);

            try {
                const response = await fetch(url, {
                    method: "GET",
                    headers: { "x-api-key": apiKey }
                });

                log(`üì° Status Server: ${response.status} ${response.statusText}`);

                // Cek kalau server error (bukan 200)
                if (!response.ok) {
                    throw new Error(`Server Error: ${response.status}`);
                }

                // Coba parsing JSON
                const textData = await response.text(); // Ambil teks mentah dulu
                log(`üì¶ Respon Mentah: ${textData.substring(0, 100)}...`); // Tampilkan dikit aja biar ga penuh

                let json;
                try {
                    json = JSON.parse(textData);
                } catch (err) {
                    log("‚ùå Gagal parsing JSON. Server mungkin kirim HTML error.", 'error');
                    throw new Error("Respon bukan JSON yang valid");
                }

                if (json.success) {
                    log("‚úÖ SUKSES! React terkirim.", 'info');
                    log(`üëâ Result: ${JSON.stringify(json)}`);
                    alert("Berhasil Wir! Cek WA coba.");
                } else {
                    log(`‚ö†Ô∏è GAGAL dari API: ${json.message || "Tanpa pesan error"}`, 'error');
                }

            } catch (error) {
                log(`‚ùå TERJADI ERROR: ${error.message}`, 'error');
                
                // Analisa Error Vira
                if (error.message.includes("Failed to fetch")) {
                    log("üí° ANALISA: Kemungkinan besar kena **CORS**. Browser ngeblok request ke API ini. Solusi: Gunakan Proxy atau jalankan script ini di sisi Server (NodeJS), bukan di Browser langsung.", 'warn');
                }
            } finally {
                btn.innerHTML = "GAS KIRIM!";
                btn.style.opacity = "1";
            }
        }
    </script>
</body>
</html>
